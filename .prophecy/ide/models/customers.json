{"id":"customers","metainfo":{"label":"customers","finalProcessID":"final##dO2GZ7JZ","autoLayout":false,"staleState":"none","sourceSuggestions":{"sources":[]},"graphConfig":{"userDefinedConfig":{"vars":{}}}},"processes":{"payments##ZZS93OTp":{"id":"payments##ZZS93OTp","component":"Model","metadata":{"label":"payments","x":120,"y":340,"phase":0},"properties":{"table":{"name":"stg_payments","sourceType":"Model"}},"ports":{"inputs":[],"outputs":[{"id":"MP7CHeW6","slug":"out"}],"isCustomOutputSchema":false}},"customers##qqEDwojA":{"id":"customers##qqEDwojA","component":"Model","metadata":{"label":"customers","x":340,"y":120,"phase":0},"properties":{"table":{"name":"stg_customers","sourceType":"Model"}},"ports":{"inputs":[],"outputs":[{"id":"KvsF176V","slug":"out"}],"isCustomOutputSchema":false}},"final##dO2GZ7JZ":{"id":"final##dO2GZ7JZ","component":"Join","metadata":{"label":"final","x":540,"y":320,"phase":0,"macroDependencies":[]},"properties":{"conditions":[{"alias":"customer_orders","expression":{"expression":"customers.customer_id = customer_orders.customer_id"},"joinType":"LEFT"},{"alias":"customer_payments","expression":{"expression":"customers.customer_id = customer_payments.customer_id"},"joinType":"LEFT"}],"expressions":[{"expression":{"expression":"customers.customer_id"}},{"expression":{"expression":"customers.first_name"}},{"expression":{"expression":"customers.last_name"}},{"expression":{"expression":"customer_orders.first_order"}},{"expression":{"expression":"customer_orders.most_recent_order"}},{"expression":{"expression":"customer_orders.number_of_orders"}},{"expression":{"expression":"customer_payments.total_amount"},"alias":"customer_lifetime_value"}],"activeTab":"conditions","columnsSelector":[],"headAlias":"customers"},"ports":{"inputs":[{"id":"rSdvDjll","slug":"customers"},{"id":"lPrUd8gn","slug":"customer_orders"},{"id":"JwZJ16LO","slug":"customer_payments"}],"outputs":[{"id":"YLHagCsT","slug":"out"}],"isCustomOutputSchema":false}},"orders##SEvyGeIY":{"id":"orders##SEvyGeIY","component":"Model","metadata":{"label":"orders","x":120,"y":540,"phase":0},"properties":{"table":{"name":"stg_orders","sourceType":"Model"}},"ports":{"inputs":[],"outputs":[{"id":"wriVvuE0","slug":"out"}],"isCustomOutputSchema":false}},"customer_orders##w34vkvqO":{"id":"customer_orders##w34vkvqO","component":"Aggregate","metadata":{"label":"customer_orders","x":340,"y":320,"phase":0,"macroDependencies":[]},"properties":{"aggregate":[{"expression":{"expression":"customer_id"}},{"expression":{"expression":"min(order_date)"},"alias":"first_order"},{"expression":{"expression":"max(order_date)"},"alias":"most_recent_order"},{"expression":{"expression":"count(order_id)"},"alias":"number_of_orders"}],"allowSelection":true,"condition":{"expression":""},"activeTab":"aggregate","columnsSelector":[],"groupBy":[{"expression":{"expression":"customer_id"}}]},"ports":{"inputs":[{"id":"D5ueWHC8","slug":"orders"}],"outputs":[{"id":"eS0khR4s","slug":"out"}],"isCustomOutputSchema":false}},"customer_payments##CpcpQOM8":{"id":"customer_payments##CpcpQOM8","component":"SQLStatement","metadata":{"label":"customer_payments","x":340,"y":540,"phase":0,"macroDependencies":[]},"properties":{"fileTabs":[{"path":"","id":"","language":"sql","content":"SELECT \n  orders.customer_id,\n  sum(amount) AS total_amount\n\nFROM payments\nLEFT JOIN orders\n   ON payments.order_id = orders.order_id\n\nGROUP BY orders.customer_id\n"}]},"ports":{"inputs":[{"id":"we8GIJ9L","slug":"payments"},{"id":"Wlku2q7b","slug":"orders"}],"outputs":[{"id":"Wz7Q8bRy","slug":"out"}],"isCustomOutputSchema":false}}},"connections":[{"id":"F2h5hb3d","source":"orders##SEvyGeIY","sourcePort":"wriVvuE0","target":"customer_orders##w34vkvqO","targetPort":"D5ueWHC8"},{"id":"kamlxdYB","source":"payments##ZZS93OTp","sourcePort":"MP7CHeW6","target":"customer_payments##CpcpQOM8","targetPort":"we8GIJ9L"},{"id":"AzYvSsJj","source":"orders##SEvyGeIY","sourcePort":"wriVvuE0","target":"customer_payments##CpcpQOM8","targetPort":"Wlku2q7b"},{"id":"CeZ2MkHK","source":"customers##qqEDwojA","sourcePort":"KvsF176V","target":"final##dO2GZ7JZ","targetPort":"rSdvDjll"},{"id":"SNSJJnXf","source":"customer_orders##w34vkvqO","sourcePort":"eS0khR4s","target":"final##dO2GZ7JZ","targetPort":"lPrUd8gn"},{"id":"SYFKiztT","source":"customer_payments##CpcpQOM8","sourcePort":"Wz7Q8bRy","target":"final##dO2GZ7JZ","targetPort":"JwZJ16LO"}],"component":"Model"}